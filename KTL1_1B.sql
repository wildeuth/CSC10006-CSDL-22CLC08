--Kiểm tra lần 1
USE MASTER 
GO
IF DB_ID('SHOPPING_1B') IS NOT NULL
	DROP DATABASE SHOPPING_1B
GO
CREATE DATABASE SHOPPING_1B
GO
USE SHOPPING_1B 
GO

CREATE TABLE CUSTOMER
(
	ID INT,
	NAME CHAR(10),
	CITY CHAR(10),

	CONSTRAINT PK_CUSTOMER PRIMARY KEY (ID)
)

CREATE TABLE ORDER_BILL
(
	O_ID CHAR(3),
	DATE_BILL DATE,
	CUSTOMER_ID INT,
	AMOUNT INT

	CONSTRAINT PK_ORDER PRIMARY KEY (O_ID)
)

CREATE TABLE PRODUCT
(
	PID CHAR(2),
	PNAME CHAR(15),
	TYPE CHAR (15)

	CONSTRAINT PK_PRODUCT PRIMARY KEY (PID)
)

CREATE TABLE DETAILS
(
	O_ID CHAR(3),
	P_ID CHAR(2)

	CONSTRAINT PK_DETAILS PRIMARY KEY (O_ID, P_ID)
)

ALTER TABLE ORDER_BILL
ADD CONSTRAINT FK_ORD_CTM FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER

ALTER TABLE DETAILS 
ADD CONSTRAINT FK_DT_ORD FOREIGN KEY (O_ID) REFERENCES ORDER_BILL,
	CONSTRAINT FK_DT_PRD FOREIGN KEY (P_ID) REFERENCES PRODUCT

INSERT CUSTOMER VALUES 
(1, 'Brian', 'Chicagon'),
(2, 'Jane', 'Houston'),
(3, 'Katie', 'Houston'),
(4, 'John', 'Houston'),
(5, 'Brian', 'San Jose')

SET DATEFORMAT DMY

INSERT ORDER_BILL VALUES
('001', '30-05-2024', 2, 200),
('002', '8-06-2024', 3, 500),
('003', '12-06-2024', 2, 100),
('004', '30-05-2024', 4, 300),
('005', '14-06-2024', 2, 400),
('006', '30-05-2024', 3, 300)

INSERT PRODUCT VALUES
('P1', 'Cinderella', 'Books'),
('P2', 'Dell XYZ', 'Computers'),
('P3', 'Aladdin', 'Books'),
('P4', 'HP 123', 'Computers')

INSERT DETAILS VALUES
('001', 'P1'),
('001', 'P3'),
('002', 'P2'),
('003', 'P2'),
('004', 'P2'),
('005', 'P2'),
('006', 'P1')

SELECT * FROM CUSTOMER
SELECT * FROM ORDER_BILL
SELECT * FROM PRODUCT
SELECT * FROM DETAILS